{"ast":null,"code":"import React__default, { useState } from 'react';\nimport { u as useForm, F as Form, H as HeaderText, S as Spacer, E as EmailInput, a as SubmitButton, b as SecondaryButton, I as Input, P as PasswordInput } from './index.esm-189a9937.js';\nimport { _ as _extends, u as useEasybase } from './index-775190d4.js';\nimport { s as styled, t as toast } from './Auth-25393280.js';\nimport { E as ErrorText } from './ErrorText-6391e3af.js';\nconst SecondaryText = styled.h2(props => _extends({\n  fontFamily: \"inherit\",\n  fontSize: 15,\n  fontWeight: 300,\n  letterSpacing: -.2,\n  lineHeight: '20px',\n  whiteSpace: 'normal'\n}, props.theme.secondaryText ? _extends({}, props.theme.secondaryText) : {}));\nfunction SecondaryText$1(props) {\n  return React__default.createElement(SecondaryText, Object.assign({}, props));\n}\nfunction ForgotPassword(_ref) {\n  let {\n    setCurrentPage,\n    dictionary,\n    emailTemplate\n  } = _ref;\n  const [onConfirm, setOnConfirm] = useState(false);\n  const [forgottenUsername, setForgottenUsername] = useState();\n  const {\n    register,\n    handleSubmit,\n    reset,\n    formState: {\n      errors,\n      isSubmitting\n    }\n  } = useForm();\n  const {\n    forgotPassword,\n    forgotPasswordConfirm\n  } = useEasybase();\n  const onSubmit = async formData => {\n    if (!formData.email) {\n      return;\n    }\n    const forgotRes = await forgotPassword(formData.email, emailTemplate);\n    if (forgotRes.success) {\n      setForgottenUsername(formData.email);\n      setOnConfirm(true);\n      toast.success('Check your email for a verification code');\n    } else {\n      if (forgotRes.errorCode === \"RequestLimitExceeded\") {\n        toast.error(dictionary.errorRequestLimitExceeded);\n      } else if (forgotRes.errorCode === \"BadFormat\") {\n        reset();\n        toast.error(dictionary.errorBadInputFormat);\n      } else if (forgotRes.errorCode === \"NoUserExists\") {\n        reset();\n        toast.error(dictionary.errorNoAccountFound);\n      } else {\n        reset();\n        toast.error('Bad request');\n      }\n    }\n  };\n  const onConfirmSubmit = async formData => {\n    if (!formData.code || !formData.newPassword || !forgottenUsername) {\n      return;\n    }\n    const forgotConfirmRes = await forgotPasswordConfirm(formData.code, forgottenUsername, formData.newPassword);\n    if (forgotConfirmRes.success) {\n      setOnConfirm(false);\n      setForgottenUsername(\"\");\n      setCurrentPage('SignIn');\n      toast.success('Password successfully changed');\n    } else {\n      if (forgotConfirmRes.errorCode === \"BadPasswordLength\") {\n        toast.error(dictionary.errorPasswordTooShort);\n      } else if (forgotConfirmRes.errorCode === \"BadFormat\") {\n        reset();\n        toast.error(dictionary.errorBadInputFormat);\n      } else if (forgotConfirmRes.errorCode === \"NoUserExists\") {\n        reset();\n        toast.error(dictionary.errorNoAccountFound);\n      } else if (forgotConfirmRes.errorCode === \"WrongVerificationCode\") {\n        toast.error(dictionary.errorWrongVerificationCode);\n      } else {\n        toast.error('Bad request');\n      }\n    }\n  };\n  const passwordReqs = {\n    minLength: {\n      value: 8,\n      message: \"Password must be at least 8 characters long\"\n    },\n    maxLength: {\n      value: 100,\n      message: \"Password too long\"\n    },\n    pattern: {\n      value: /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{7,}$/gm,\n      message: \"Must contain a digit and uppercase and lowercase letters\"\n    }\n  };\n  const codeReqs = {\n    minLength: {\n      value: 8,\n      message: \"Incorrect code length\"\n    }\n  };\n  if (!onConfirm) {\n    return React__default.createElement(Form, {\n      onSubmit: handleSubmit(onSubmit)\n    }, React__default.createElement(HeaderText, null, dictionary.forgotPasswordHeader), React__default.createElement(SecondaryText$1, null, dictionary.forgotPasswordSecondaryHeader), React__default.createElement(Spacer, {\n      size: \"medium\"\n    }), React__default.createElement(EmailInput, {\n      register: () => register(\"email\"),\n      label: dictionary.newEmailLabel,\n      disabled: isSubmitting\n    }), React__default.createElement(Spacer, {\n      size: \"medium\"\n    }), React__default.createElement(SubmitButton, {\n      disabled: isSubmitting\n    }, dictionary.forgotPasswordSubmitButton), React__default.createElement(SecondaryButton, {\n      onClick: _ => setCurrentPage(\"SignIn\"),\n      disabled: isSubmitting\n    }, dictionary.backToSignIn));\n  } else {\n    var _errors$code, _errors$newPassword;\n    return React__default.createElement(Form, {\n      onSubmit: handleSubmit(onConfirmSubmit)\n    }, React__default.createElement(HeaderText, null, dictionary.forgotPasswordConfirmHeader), React__default.createElement(Spacer, {\n      size: \"medium\"\n    }), React__default.createElement(Input, {\n      register: () => register(\"code\", codeReqs),\n      label: dictionary.codeLabel,\n      disabled: isSubmitting\n    }), React__default.createElement(ErrorText, {\n      value: (_errors$code = errors.code) == null ? void 0 : _errors$code.message\n    }), React__default.createElement(Spacer, {\n      size: \"xlarge\"\n    }), React__default.createElement(PasswordInput, {\n      register: () => register(\"newPassword\", passwordReqs),\n      label: dictionary.forgotPasswordConfirmLabel,\n      autoComplete: \"new-password\",\n      disabled: isSubmitting\n    }), React__default.createElement(ErrorText, {\n      value: (_errors$newPassword = errors.newPassword) == null ? void 0 : _errors$newPassword.message\n    }), React__default.createElement(Spacer, {\n      size: \"xlarge\"\n    }), React__default.createElement(SubmitButton, {\n      disabled: isSubmitting\n    }, dictionary.forgotPasswordConfirmSubmitButton));\n  }\n}\nexport { ForgotPassword as default };","map":{"version":3,"names":["SecondaryText","styled","h2","props","_extends","fontFamily","fontSize","fontWeight","letterSpacing","lineHeight","whiteSpace","theme","secondaryText","React__default","createElement","Object","assign","setCurrentPage","dictionary","emailTemplate","_ref","onConfirm","setOnConfirm","useState","forgottenUsername","setForgottenUsername","register","handleSubmit","reset","formState","errors","isSubmitting","useForm","forgotPassword","forgotPasswordConfirm","useEasybase","onSubmit","formData","email","forgotRes","success","toast","errorCode","error","errorRequestLimitExceeded","errorBadInputFormat","errorNoAccountFound","onConfirmSubmit","code","newPassword","forgotConfirmRes","errorPasswordTooShort","errorWrongVerificationCode","passwordReqs","minLength","value","message","maxLength","pattern","codeReqs","Form","HeaderText","forgotPasswordHeader","SecondaryText$1","forgotPasswordSecondaryHeader","Spacer","size","EmailInput","label","newEmailLabel","disabled","SubmitButton","forgotPasswordSubmitButton","SecondaryButton","onClick","_","backToSignIn","_errors$code","_errors$newPassword","forgotPasswordConfirmHeader","Input","codeLabel","ErrorText","PasswordInput","forgotPasswordConfirmLabel","autoComplete","forgotPasswordConfirmSubmitButton"],"sources":["I:\\React\\01-starting-setup\\node_modules\\easybase-react\\src\\ui\\Auth\\components\\SecondaryText.tsx","I:\\React\\01-starting-setup\\node_modules\\easybase-react\\src\\ui\\Auth\\pages\\ForgotPassword.tsx"],"sourcesContent":["import React from 'react';\nimport styled from 'styled-components';\n\nconst SecondaryText = styled.h2(props => ({\n    fontFamily: \"inherit\",\n    fontSize: 15,\n    fontWeight: 300,\n    letterSpacing: -.2,\n    lineHeight: '20px',\n    whiteSpace: 'normal',\n    ...(props.theme.secondaryText ? { ...props.theme.secondaryText } : {})\n}))\n\nexport default function (props: React.HTMLAttributes<HTMLHeadingElement>) {\n    return (\n        <SecondaryText {...props} />\n    )\n}\n","import React, { useState } from 'react';\nimport Form from '../components/Form';\nimport EmailInput from '../components/EmailInput';\nimport HeaderText from '../components/HeaderText';\nimport SecondaryText from '../components/SecondaryText';\nimport SecondaryButton from '../components/SecondaryButton';\nimport SubmitButton from '../components/SubmitButton';\nimport Spacer from '../components/Spacer';\nimport { useForm } from 'react-hook-form';\nimport { IPage } from '../../uiTypes';\nimport toast from 'react-hot-toast';\nimport ErrorText from '../components/ErrorText';\nimport Input from '../components/internal/Input';\nimport PasswordInput from '../components/PasswordInput';\nimport useEasybase from '../../../useEasybase';\n\nexport default function ({ setCurrentPage, dictionary, emailTemplate }: IPage) {\n    const [onConfirm, setOnConfirm] = useState<boolean>(false);\n    const [forgottenUsername, setForgottenUsername] = useState<string | undefined>();\n    const { register, handleSubmit, reset, formState: { errors, isSubmitting } } = useForm();\n    const { forgotPassword, forgotPasswordConfirm } = useEasybase();\n\n    const onSubmit = async (formData: Record<string, string>) => {\n        if (!formData.email) {\n            return;\n        }\n\n        const forgotRes = await forgotPassword(formData.email, emailTemplate);\n        if (forgotRes.success) {\n            setForgottenUsername(formData.email);\n            setOnConfirm(true);\n            toast.success('Check your email for a verification code')\n        } else {\n            if (forgotRes.errorCode === \"RequestLimitExceeded\") {\n                toast.error(dictionary.errorRequestLimitExceeded!);\n            } else if (forgotRes.errorCode === \"BadFormat\") {\n                reset();\n                toast.error(dictionary.errorBadInputFormat!);\n            } else if (forgotRes.errorCode === \"NoUserExists\") {\n                reset();\n                toast.error(dictionary.errorNoAccountFound!);\n            } else {\n                reset();\n                toast.error('Bad request');\n            }\n        }\n    }\n\n    const onConfirmSubmit = async (formData: Record<string, string>) => {\n        if (!formData.code || !formData.newPassword || !forgottenUsername) {\n            return;\n        }\n        const forgotConfirmRes = await forgotPasswordConfirm(formData.code, forgottenUsername, formData.newPassword)\n        if (forgotConfirmRes.success) {\n            setOnConfirm(false);\n            setForgottenUsername(\"\");\n            setCurrentPage('SignIn');\n            toast.success('Password successfully changed')\n        } else {\n            if (forgotConfirmRes.errorCode === \"BadPasswordLength\") {\n                toast.error(dictionary.errorPasswordTooShort!);\n            } else if (forgotConfirmRes.errorCode === \"BadFormat\") {\n                reset();\n                toast.error(dictionary.errorBadInputFormat!);\n            } else if (forgotConfirmRes.errorCode === \"NoUserExists\") {\n                reset();\n                toast.error(dictionary.errorNoAccountFound!);\n            } else if (forgotConfirmRes.errorCode === \"WrongVerificationCode\") {\n                toast.error(dictionary.errorWrongVerificationCode!);\n            } else {\n                toast.error('Bad request');\n            }\n        }\n    }\n\n    const passwordReqs = {\n        minLength: {\n            value: 8,\n            message: \"Password must be at least 8 characters long\"\n        },\n        maxLength: {\n            value: 100,\n            message: \"Password too long\"\n        },\n        pattern: {\n            value: /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{7,}$/gm,\n            message: \"Must contain a digit and uppercase and lowercase letters\"\n        }\n    }\n\n    const codeReqs = {\n        minLength: {\n            value: 8,\n            message: \"Incorrect code length\"\n        }\n    }\n\n    if (!onConfirm) {\n        return (\n            <Form onSubmit={handleSubmit(onSubmit)}>\n                <HeaderText>{dictionary.forgotPasswordHeader}</HeaderText>\n                <SecondaryText>{dictionary.forgotPasswordSecondaryHeader}</SecondaryText>\n                <Spacer size=\"medium\" />\n                <EmailInput\n                    register={() => register(\"email\")}\n                    label={dictionary.newEmailLabel}\n                    disabled={isSubmitting}\n                />\n                <Spacer size=\"medium\" />\n                <SubmitButton disabled={isSubmitting}>{dictionary.forgotPasswordSubmitButton}</SubmitButton>\n                <SecondaryButton onClick={_ => setCurrentPage(\"SignIn\")} disabled={isSubmitting}>{dictionary.backToSignIn}</SecondaryButton>\n            </Form>\n        )\n    } else {\n        return (\n            <Form onSubmit={handleSubmit(onConfirmSubmit)}>\n                <HeaderText>{dictionary.forgotPasswordConfirmHeader}</HeaderText>\n                <Spacer size=\"medium\" />\n                <Input\n                    register={() => register(\"code\", codeReqs)}\n                    label={dictionary.codeLabel!}\n                    disabled={isSubmitting}\n                />\n                <ErrorText value={errors.code?.message} />\n                <Spacer size=\"xlarge\" />\n                <PasswordInput\n                    register={() => register(\"newPassword\", passwordReqs)}\n                    label={dictionary.forgotPasswordConfirmLabel}\n                    autoComplete=\"new-password\"\n                    disabled={isSubmitting}\n                />\n                <ErrorText value={errors.newPassword?.message} />\n                <Spacer size=\"xlarge\" />\n                <SubmitButton disabled={isSubmitting}>{dictionary.forgotPasswordConfirmSubmitButton}</SubmitButton>\n            </Form>\n        )\n    }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}